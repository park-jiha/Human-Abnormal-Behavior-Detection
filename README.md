# Human Abnormal Behavior Detection

## Code Update
- 2022.6.10 ver. : 1차 데모 / model_demo(220610).py
- 2022.6.13 ver. : 1차 데모 후 피드백 -> srt 파일 생성 부분 간소화 / demo_0613.py
- 2022.6.20 ver. : 코드 간소화, 낙상 후 이벤트 초기화 / main_0620.py
- 2022.6.22 ver. : 첫 detection 안될 시 imshow 안되는 현상 수정 / main_0622.py

## YOLO cfg, weights
https://github.com/WongKinYiu/ScaledYOLOv4

## 주제 : 이상행동 분류 (낙상 검출) with 싱스웰

## 구성원
### 1. 박지하 / 개발, 리더 / 데이터 수집 및 가공, 학습모델 개발
### 2. 김지은 / 개발 / 데이터 수집 및 가공, 결과 출력 및 저장

## 목적
- 고령층에서 빈번히 일어나는 생활 ‧ 안전 사고에 신속대응과 사전 예방을 목적으로 한다.
- 낙상사고 등으로 인해 골절이나 부상을 입게 될 경우, 직접적으로 거동이 어려워지기 때문에 이로 인한 사고 예방이 필요하다.
- 이상행동 영상데이터 학습을 통해 이상행동(낙상) 등을 분류할 수 있는 모델을 구축한다.
- 본 프로젝트를 통해 이상행동(낙상)을 실시간으로 감지하고, 큰 사고로 이어지는 것을 막아 보호할 수 있는 시스템을 완성하는 것이 목적이다.

## 개발 내용
- 데이터 학습을 통해 사람의 이상행동(낙상)을 감지 및 분류한다.
- Yolo 모델을 이용하여 human detection 후 landmark 추출을 통해 얻은 정보를 바탕으로 낙상 유무를 판단하는 모델 개발도 시도해본다.
- 낙상은 이동 중에 옆으로 낙상, 이동 중에 뒤로 낙상, 이동 중에 앞으로 낙상, 제자리에서 옆으로 낙상, 제자리에서 뒤로 낙상, 제자리에서 앞으로 낙상을 감지하도록 한다.
- Object 좌표 값과 이상행동 유형, 이상행동 시작 프레임, 이상행동 종료 프레임 등을 학습하여 이상행동(낙상)에 따른 행동을 분류한다.
- 여러 모델 개발을 시도하며 최적의 결과를 낼 수 있는 모델로 최종 선정한다.

## 개발 Specification
- 환경 : python 3.9.12 / numpy 1.22.4 / pandas 1.4.2 / opencv gpu 4.5.5
- Test 동영상 setting : 1920 x 1080, 15 fps
- 동영상 데이터 처리 : opencv gpu
- 사람 검출 (Human Detection) : yolov4 p6 config & weight 사용
- 사람의 관절 keypoint 추출 : Google mediapipe 의 blazepose 사용
- 낙상 여부 판단 : Bounding box 의 height & weight 변화 속도 계산
- 낙상 방향 판단 : 총 3 가지 방향 전방 낙상 후방 낙상 측면 낙상 감지, Bounding box 의 height & weight 위치 및 변화 특징 구분

## 참고 문헌
[1] 김지민, 윤기범, 심정용, 박소영, 신연순. (2020) YOLOv3 알고리즘을 이용한 실시간 낙상 검출<br>
[2] 황세현, 반성범. (2016) 오픈 소스 하드웨어와 RGB 카메라를 이용한 낙상 검출시스템
